.. warning::

   Internal data structures are outdated. Please contact us for details.


.. _plynx-internal:

========================
Internal data structures
========================

This section is meant for advanced users.
PLynx exposes Rest API for creating Graphs and Nodes and monitoring their states.
We will give you an overview of these objects below.

.. contents:: Table of Contents
    :local:
    :depth: 1

===========================


.. _plynx-internal-graph:

Graph
======================

Graph is a basic structure of experiments.
The Graph defines layout of Operations and Files and their dependancies.
See :ref:`intro-graph`.


+----------------------+-------------+--------------------------------------------------------------------------+
| Field Name           | Type        | Description                                                              |
+======================+=============+==========================================================================+
| _id                  | ``STRING``  | Unique ID of the Graph.                                                  |
+----------------------+-------------+--------------------------------------------------------------------------+
| title                | ``STRING``  | Title string of the Graph.                                               |
+----------------------+-------------+--------------------------------------------------------------------------+
| description          | ``STRING``  | Description string of the Graph.                                         |
+----------------------+-------------+--------------------------------------------------------------------------+
| author               | ``STRING``  | ID of the author.                                                        |
+----------------------+-------------+--------------------------------------------------------------------------+
| graph_running_status | ``STRING``  | Current status. :ref:`plynx-internal-graph_running_status`               |
+----------------------+-------------+--------------------------------------------------------------------------+
| insertion_date       | ``STRING``  | Date time when the record was created in format `%Y-%m-%d %H:%M:%S.%LZ`. |
+----------------------+-------------+--------------------------------------------------------------------------+
| update_date          | ``STRING``  | Date time when the record was updated in format `%Y-%m-%d %H:%M:%S.%LZ`. |
+----------------------+-------------+--------------------------------------------------------------------------+
| nodes                | ``LIST``    | List for the nodes. See :ref:`plynx-internal-node`.                      |
+----------------------+-------------+--------------------------------------------------------------------------+
| _readonly            | ``BOOLEAN`` | Flag that shows if current user has write access to this object.         |
+----------------------+-------------+--------------------------------------------------------------------------+



.. _plynx-internal-graph_running_status:

Graph Running Status
------------------------

+--------------------+----------------------------------------------------------------------------------------------------+
| Value              | Description                                                                                        |
+====================+====================================================================================================+
| ``CREATED``        | Initial state of the Graph. Users can make changes in it.                                          |
+--------------------+----------------------------------------------------------------------------------------------------+
| ``READY``          | The Graph was approved. No changes accepted.                                                       |
+--------------------+----------------------------------------------------------------------------------------------------+
| ``RUNNING``        | Master took control over the Graph and is working on execution.                                    |
+--------------------+----------------------------------------------------------------------------------------------------+
| ``SUCCESS``        | Execution of the Graph finished successfully.                                                      |
+--------------------+----------------------------------------------------------------------------------------------------+
| ``FAILED_WAITING`` | One or more Operations failed during execution. Waiting for the rest of operations to be canceled. |
+--------------------+----------------------------------------------------------------------------------------------------+
| ``FAILED``         | One or more Operations failed during execution.                                                    |
+--------------------+----------------------------------------------------------------------------------------------------+
| ``CANCELED``       | User canceled execution.                                                                           |
+--------------------+----------------------------------------------------------------------------------------------------+


.. _plynx-internal-node:

Node
======================

Operations and Files are derived from Nodes.
See :ref:`intro-node`.


+---------------------+-------------+-------------------------------------------------------------------------------------------+
| Field Name          | Type        | Description                                                                               |
+=====================+=============+===========================================================================================+
| _id                 | ``STRING``  | Unique ID of the Node.                                                                    |
+---------------------+-------------+-------------------------------------------------------------------------------------------+
| title               | ``STRING``  | Title string of the Node.                                                                 |
+---------------------+-------------+-------------------------------------------------------------------------------------------+
| description         | ``STRING``  | Description string of the Node.                                                           |
+---------------------+-------------+-------------------------------------------------------------------------------------------+
| author              | ``STRING``  | ID of the author.                                                                         |
+---------------------+-------------+-------------------------------------------------------------------------------------------+
| node_running_status | ``STRING``  | Status of the Node inside a Graph. :ref:`plynx-internal-node_running_status`              |
+---------------------+-------------+-------------------------------------------------------------------------------------------+
| node_status         | ``STRING``  | Status of the Node. :ref:`plynx-internal-node_status`                                     |
+---------------------+-------------+-------------------------------------------------------------------------------------------+
| insertion_date      | ``STRING``  | Date time when the record was created in format `%Y-%m-%d %H:%M:%S.%LZ`.                  |
+---------------------+-------------+-------------------------------------------------------------------------------------------+
| update_date         | ``STRING``  | Date time when the record was updated in format `%Y-%m-%d %H:%M:%S.%LZ`.                  |
+---------------------+-------------+-------------------------------------------------------------------------------------------+
| _readonly           | ``BOOLEAN`` | Flag that shows if current user has write access to this object.                          |
+---------------------+-------------+-------------------------------------------------------------------------------------------+
| base_node_name      | ``STRING``  | Base Node name. :ref:`plynx-concepts-base_node_name`                                      |
+---------------------+-------------+-------------------------------------------------------------------------------------------+
| cache_url           | ``STRING``  | URL to the cached operation.                                                              |
+---------------------+-------------+-------------------------------------------------------------------------------------------+
| parent_node_id      | ``STRING``  | Reference to the parent Node. It refers to `nodes` collection.                            |
+---------------------+-------------+-------------------------------------------------------------------------------------------+
| starred             | ``BOOLEAN`` | Flag is set to `true` if the Node is prioritized.                                         |
+---------------------+-------------+-------------------------------------------------------------------------------------------+
| successor_node_id   | ``STRING``  | If the Node is deprecated this field will reference to a successor in `nodes` collection. |
+---------------------+-------------+-------------------------------------------------------------------------------------------+
| x                   | ``INTEGER`` | `X` position in the Graph.                                                                |
+---------------------+-------------+-------------------------------------------------------------------------------------------+
| y                   | ``INTEGER`` | `Y` position in the Graph.                                                                |
+---------------------+-------------+-------------------------------------------------------------------------------------------+
| inputs              | ``LIST``    | List for the Inputs. See :ref:`plynx-internal-input`.                                     |
+---------------------+-------------+-------------------------------------------------------------------------------------------+
| parameters          | ``LIST``    | List for the Parameters. See :ref:`plynx-internal-parameter`.                             |
+---------------------+-------------+-------------------------------------------------------------------------------------------+
| logs                | ``LIST``    | List for the Logs. See :ref:`plynx-internal-log`.                                         |
+---------------------+-------------+-------------------------------------------------------------------------------------------+
| outputs             | ``LIST``    | List for the Outputs. See :ref:`plynx-internal-output`.                                   |
+---------------------+-------------+-------------------------------------------------------------------------------------------+


.. _plynx-internal-input:

Input
------------------------

+------------+-------------+----------------------------------------------------------+
| Field Name | Type        | Description                                              |
+============+=============+==========================================================+
| name       | ``STRING``  | Name of the Input.                                       |
+------------+-------------+----------------------------------------------------------+
| file_types | ``LIST``    | List of file types. See :ref:`plynx-plugins-file_types`. |
+------------+-------------+----------------------------------------------------------+
| values     | ``LIST``    | List of Values. See :ref:`plynx-internal-input_value`.   |
+------------+-------------+----------------------------------------------------------+
| min_count  | ``INTEGER`` | Minimum number of Inputs.                                |
+------------+-------------+----------------------------------------------------------+
| max_count  | ``INTEGER`` | Maximum number of Inputs.                                |
+------------+-------------+----------------------------------------------------------+


.. _plynx-internal-input_value:

Input Value
------------------------

+-------------+------------+-----------------------------------------------------+
| Field Name  | Type       | Description                                         |
+=============+============+=====================================================+
| node_id     | ``STRING`` | ID of the Node the Operation depends on in a Graph. |
+-------------+------------+-----------------------------------------------------+
| output_id   | ``STRING`` | Name of the Output in the Operation it depends on.  |
+-------------+------------+-----------------------------------------------------+
| resource_id | ``STRING`` | Reference to a resource.                            |
+-------------+------------+-----------------------------------------------------+


.. _plynx-internal-parameter:

Parameter
------------------------

+----------------+-------------+-----------------------------------------------------------------------------------------------+
| Field Name     | Type        | Description                                                                                   |
+================+=============+===============================================================================================+
| name           | ``STRING``  | Name of the Parameter.                                                                        |
+----------------+-------------+-----------------------------------------------------------------------------------------------+
| parameter_type | ``LIST``    | List of parameter types. See :ref:`intro-parameter_types`.                                    |
+----------------+-------------+-----------------------------------------------------------------------------------------------+
| value          | ``-``       | Type is specific to parameter type.                                                           |
+----------------+-------------+-----------------------------------------------------------------------------------------------+
| mutable_type   | ``BOOLEAN`` | Flag specifies if user can change `parameter_type`.                                           |
+----------------+-------------+-----------------------------------------------------------------------------------------------+
| removable      | ``BOOLEAN`` | Flag specifies if user can remove the Parameter.                                              |
+----------------+-------------+-----------------------------------------------------------------------------------------------+
| publicable     | ``BOOLEAN`` | Flag specifies if user can publish the Parameter.                                             |
+----------------+-------------+-----------------------------------------------------------------------------------------------+
| widget         | ``OBJECT``  | `Null` of `Object` with the field ``alias``. It contains the name of the parameter in the UI. |
+----------------+-------------+-----------------------------------------------------------------------------------------------+


.. _plynx-internal-output:

Output
------------------------

+-------------+------------+-------------------------------------------------+
| Field Name  | Type       | Description                                     |
+=============+============+=================================================+
| name        | ``STRING`` | Name of the Output.                             |
+-------------+------------+-------------------------------------------------+
| file_type   | ``STRING`` | File type. See :ref:`plynx-plugins-file_types`. |
+-------------+------------+-------------------------------------------------+
| resource_id | ``STRING`` | Reference to the file.                          |
+-------------+------------+-------------------------------------------------+


.. _plynx-internal-log:

Log
------------------------

Similar to :ref:`plynx-internal-output`. Field ``file_type`` is always set to ``file``.



.. _plynx-internal-node_running_status:

Node Running Status
------------------------

This enum describes the state of the Node in the Graph.

+--------------+--------------------------------------------------------------------+
| Value        | Description                                                        |
+==============+====================================================================+
| ``STATIC``   | Usually Files have this status. This status never change.          |
+--------------+--------------------------------------------------------------------+
| ``CREATED``  | Initial state of the Node in the Graph.                            |
+--------------+--------------------------------------------------------------------+
| ``IN_QUEUE`` | Operation is ready to be executed.                                 |
+--------------+--------------------------------------------------------------------+
| ``RUNNING``  | A worker is working on execution.                                  |
+--------------+--------------------------------------------------------------------+
| ``SUCCESS``  | Operation has been completed                                       |
+--------------+--------------------------------------------------------------------+
| ``RESTORED`` | Result of the Operation has been restored from previous execution. |
+--------------+--------------------------------------------------------------------+
| ``FAILED``   | Operation has failed during execution.                             |
+--------------+--------------------------------------------------------------------+
| ``CANCELED`` | User canceled execution.                                           |
+--------------+--------------------------------------------------------------------+


.. _plynx-internal-node_status:

Node Status
------------------------

This enum describes global the state of the Node.

+--------------------------+---------------------------------------------------------------+
| Value                    | Description                                                   |
+==========================+===============================================================+
| ``CREATED``              | Initial state of the Node. Users can still Modify it.         |
+--------------------------+---------------------------------------------------------------+
| ``READY``                | Operation is ready to be used in Graphs.                      |
+--------------------------+---------------------------------------------------------------+
| ``DEPRECATED``           | Usage of the Operation is not recommended but it can be used. |
+--------------------------+---------------------------------------------------------------+
| ``MANDATORY_DEPRECATED`` | Usage of the Operation is not allowed.                        |
+--------------------------+---------------------------------------------------------------+
